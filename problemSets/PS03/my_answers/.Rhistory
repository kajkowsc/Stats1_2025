rm(list=ls())
# Detach all libraries
detachAllPackages <- function() {
basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
package.list <- setdiff(package.list, basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()
# Load libraries
pkgTest <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
if (length(new.pkg))
install.packages(new.pkg,  dependencies = TRUE)
sapply(pkg,  require,  character.only = TRUE)
}
# Load any necessary packages
lapply(c("stargazer", "vioplot", "arm"),  pkgTest)
# Set working directory for current folder
setwd(/Users/carolinekajkowski/Desktop/Trinity/Statistical Analysis I/Stats2025/tutorials/Week 9)
df <- read.csv("ESS10.csv"
df_s <- df[df$cntry=="IE", c("euftf","edlvdie","eduyrs","hinctnta","trstplt",
df <- read.csv("ESS10.csv")
rm(list=ls())
# Detach all libraries
detachAllPackages <- function() {
basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
package.list <- setdiff(package.list, basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()
# Load libraries
pkgTest <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
if (length(new.pkg))
install.packages(new.pkg,  dependencies = TRUE)
sapply(pkg,  require,  character.only = TRUE)
}
# Load any necessary packages
lapply(c("stargazer", "vioplot", "arm"),  pkgTest)
# Set working directory for current folder
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
getwd()
df <- read.csv("../../datasets/ESS10.csv")
df_s <- df[df$cntry=="IE", c("euftf","edlvdie","eduyrs","hinctnta","trstplt",
"imwbcnt","gndr","agea","brncntr")]
View(df_s)
table(df_s$euftf)
df_s["euftf_re"] = 10 - df_s[ ,c("euftf")]
table(df_s$euftf_re)
# Junior Cycle: values 1-4
df_s[(df_s$edlvdie==1) | (df_s$edlvdie==2) | (df_s$edlvdie==3) | (df_s$edlvdie==4), c("edu_cat")] <- 1
# Leaving Certificate: values 5-9
df_s[(df_s$edlvdie==5) | (df_s$edlvdie==6) | (df_s$edlvdie==7) | (df_s$edlvdie==8) | (df_s$edlvdie==9), c("edu_cat")] <- 2
# Advanced Certificate: values 10-12
df_s[(df_s$edlvdie==10) | (df_s$edlvdie==11) | (df_s$edlvdie==12), c("edu_cat")] <- 3
# Bachelor Degree: values 13-15
df_s[(df_s$edlvdie==13) | (df_s$edlvdie==14) | (df_s$edlvdie==15), c("edu_cat")] <- 4
# Postgraduate Degree: values 16-18
df_s[(df_s$edlvdie==16) | (df_s$edlvdie==17) | (df_s$edlvdie==18), c("edu_cat")] <- 5
df_s$edu_cat <- factor(df_s$edu_cat,
levels = c(1,2,3,4,5),
labels = c("Junior Cycle",
"Leaving Certificate",
"Advanced Certificate",
"Bachelor Degree",
"Postgraduate Degree"))
levels(df_s$edu_cat)
typeof(df_s$edu_cat)
df_s[(df_s == -67) | (df_s == -78) | (df_s == -89) | (df_s == 77) | (df_s == 88) |
(df_s == 99) | (df_s == 5555) | (df_s == 7777) | (df_s == 8888) | (df_s == 9999)] <- NA
vioplot(df_s$euftf_re ~ df_s$edu_cat)
plot(df_s$edlvdie, df_s$euftf_re)
# Jittered scatter plot: Adds noise to reduce overlap of points
plot(jitter(df_s$edlvdie, 2), jitter(df_s$euftf_re, 2))
model_base <- # lm(euftf ~ gndr + agea + brncntr, data = df_s)
summary(model_base)
model_base <- # lm(formula = euftf ~ gndr + agea + brncntr, data = df_s)
summary(model_base)
model_base <- # lm(euftf ~ gndr + agea + brncntr, data = df_s)
summary(model_base)
model_base <- lm(euftf ~ gndr + agea + brncntr, data = df_s)
summary(model_base)
model1_cont <- lm(euftf ~ edlvdie, df = df_s)
model1_cont <- lm(euftf ~ edlvdie, df = df_s)
model1_cont <- lm(euftf ~ edlvdie, data = df_s)
summary(model1_cont)
model1_cont <- lm(euftf_re ~ edlvdie, data = df_s)
summary(model1_cont)
plot(df_s$edu_cat)
df_s$edu_cat <- relevel(df_s$edu_cat, ref = 2)
model1_cat <- lm(euftf_re ~ edu_cat, df_s)
summary(model1_cat)
plot(df_s$edu_cat)
df_s$edu_cat <- relevel(df_s$edu_cat, ref = 2)
model1_cat <- lm(euftf_re ~ edu_cat, df_s)
summary(model1_cat)
df_s$edu_cat <- relevel(df_s$edu_cat, ref = 2)
model1_cat <- lm(euftf_re ~ edu_cat, df_s)
summary(model1_cat)
model2 <- lm(euft_re ~ hinctnta, data = df_s)
model2 <- lm(euft_re ~ hinctnta, data = df_s)
model2 <- lm(euftf_re ~ hinctnta, data = df_s)
summary(model2)
model3 <- lm(euftf_re ~ trstplt, data = df_s)
summary(model3)
model4 <- lm(euftf_re ~ imwbcnt, data = df_s)
summary(model4)
model_pol <- lm(euftf_re ~ edlvdie + hinctnta + trstplt, df_s)
summary(model_pol)
biregress_1 <- lm(voteshare ~ difflog, data = inc.sub)
#####################
# load libraries
# set wd
# clear global .envir
#####################
# remove objects
rm(list=ls())
# detach all libraries
detachAllPackages <- function() {
basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
package.list <- setdiff(package.list, basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()
# load libraries
pkgTest <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
if (length(new.pkg))
install.packages(new.pkg,  dependencies = TRUE)
sapply(pkg,  require,  character.only = TRUE)
}
# here is where you load any necessary packages
# ex: stringr
# lapply(c("stringr"),  pkgTest)
# set wd for current folder
setwd("/Users/carolinekajkowski/Desktop/Trinity/Statistical Analysis I/Stats2025/problemSets/PS03/my_answers")
# read in data
inc.sub <- read.csv("/Users/carolinekajkowski/Desktop/Trinity/Statistical Analysis I/Stats2025/datasets/incumbents_subset.csv")
biregress_1 <- lm(voteshare ~ difflog, data = inc.sub)
summary(biregress_1)
stargazer(biregress_1,
type = "latex",
title = "Incumbent Vote share Explained by Difference of Spending",
column.labels = "Coefficinents (Reg 1)",
covariate.labels = "difflog",
dep.var.labels = "voteshare")
library(stargazer)
inc.sub <- read.csv("/Users/carolinekajkowski/Desktop/Trinity/Statistical Analysis I/Stats2025/datasets/incumbents_subset.csv")
packages("stargazer")
biregress_1 <- lm(voteshare ~ difflog, data = inc.sub)
summary(biregress_1)
stargazer(biregress_1,
type = "latex",
title = "Incumbent Vote share Explained by Difference of Spending",
column.labels = "Coefficinents (Reg 1)",
covariate.labels = "difflog",
dep.var.labels = "voteshare")
# read in data
inc.sub <- read.csv("/Users/carolinekajkowski/Desktop/Trinity/Statistical Analysis I/Stats2025/datasets/incumbents_subset.csv")
install.packages("stargazer")
library(stargazer)
biregress_1 <- lm(voteshare ~ difflog, data = inc.sub)
summary(biregress_1)
stargazer(biregress_1,
type = "latex",
title = "Incumbent Vote Share explained by Difference of Spending",
column.labels = "Coefficinents (Reg 1)",
covariate.labels = "difflog",
dep.var.labels = "voteshare")
biregress_1 <- lm(voteshare ~ difflog, data = inc.sub)
summary(biregress_1)
stargazer(biregress_1,
type = "latex",
title = "Incumbent Vote Share explained by Difference of Spending",
column.labels = "Coefficinents (Reg 1)",
covariate.labels = "difflog",
dep.var.labels = "voteshare")
biregress_1 <- lm(voteshare ~ difflog, data = inc.sub)
summary(biregress_1)
stargazer(biregress_1,
type = "latex",
title = "Incumbent Vote Share explained by Difference of Spending",
column.labels = "Coefficinents (Reg 1)",
covariate.labels = "difflog",
dep.var.labels = "voteshare")
# -----------------------------------------------------------
# Monte Carlo Simulation and Resampling Methods for Social Science
# Adopted from: Carsey, T. M. & Harden, J. J.
# Source: https://stackoverflow.com/questions/4090169/elegant-way-to-check-for-missing-packages-and-install-them
# -----------------------------------------------------------
# Package setup: install if missing, then load
if (!require(mvtnorm)) {
install.packages("mvtnorm")
library(mvtnorm)
}
# Two examples from the book
# (a.) Omitted variable bias
# (b.) Regression with random variable
set.seed(37943)   # Set seed for reproducibility
reps <- 1000      # Number of repetitions
b0 <- .2          # True intercept
b1 <- .5          # True slope for X1
b2 <- .75         # True slope for X2
n  <- 1000        # Sample size
cor.level <- c(0, .1, .2, .3, .4, .5, .6, .7, .8, .9, .99)
summary(biregress_1)
stargazer(biregress_2,
type = "latex",
title = "Presidential Candidate Vote Share explained by Difference of Spending",
column.labels = "Coefficients (biregress 2)",
covariate.labels = "difflog",
dep.var.labels = "presvote")
biregress_2 <- lm(presvote ~ difflog, data = inc.sub)
summary(biregress_2)
stargazer(biregress_2,
type = "latex",
title = "Presidential Candidate Vote Share explained by Difference of Spending",
column.labels = "Coefficients (biregress 2)",
covariate.labels = "difflog",
dep.var.labels = "presvote")
par.est.ov <- matrix(NA, nrow = reps, ncol = length(cor.level))
par.est.ov <- matrix(NA, nrow = reps, ncol = length(cor.level))
# Monte Carlo simulation loop
for (j in 1:length(cor.level)) {      # loop over correlation levels
for (i in 1:reps) {                 # loop over replications
X.corr <- matrix(c(1, cor.level[j], cor.level[j], 1), nrow = 2)
X <- rmvnorm(n, mean = c(0, 0), sigma = X.corr)   # correlated IVs
X1 <- X[, 1]
X2 <- X[, 2]
Y <- b0 + b1 * X1 + b2 * X2 + rnorm(n, 0, 1)      # true DGP
model <- lm(Y ~ X1)                               # omit X2
par.est.ov[i, j] <- model$coef[2]                 # store coefficient
}
}
par.est.ov
mean(par.est.ov[, 1])  # r = 0
mean(par.est.ov[, 2])  # r = 0.1
mean(par.est.ov[, 3])  # r = 0.2
mean(par.est.ov[, 4])  # r = 0.3
mean(par.est.ov[, 5])  # r = 0.4
mean(par.est.ov[, 6])  # r = 0.5
mean(par.est.ov[, 7])  # r = 0.6
mean(par.est.ov[, 8])  # r = 0.7
mean(par.est.ov[, 9])  # r = 0.8
mean(par.est.ov[, 10]) # r = 0.9
mean(par.est.ov[, 11]) # r = 0.99
plot(density(par.est.ov[, 1]), xlim = c(0, 1.5), ylim = c(0, 12))
lines(density(par.est.ov[, 3]), col = "gray")
lines(density(par.est.ov[, 6]), col = "orange")
lines(density(par.est.ov[, 11]), col = "red")
abline(v = b1, col = "black")
legend(0, 12,
legend = c("r=0", "r=0.2", "r=0.5", "r=0.99"),
col = c("black", "gray", "orange", "red"),
pch = 1)
library(ggplot2)
# Prepare data for ggplot
df_plot <- data.frame(
b1_est = c(par.est.ov[, 1], par.est.ov[, 3], par.est.ov[, 6], par.est.ov[, 11]),
r = factor(rep(c("r = 0", "r = 0.2", "r = 0.5", "r = 0.99"),
each = nrow(par.est.ov)))
)
# Plot
ggplot(df_plot, aes(x = b1_est, fill = r, color = r)) +
geom_density(alpha = 0.3, size = 1) +
geom_vline(xintercept = b1, color = "black", linetype = "dashed") +
scale_fill_manual(values = c("black", "gray60", "orange", "red")) +
scale_color_manual(values = c("black", "gray60", "orange", "red")) +
labs(title = "Effect of Omitted Variable Bias under Different Correlations",
x = expression(hat(beta)[1] ~ "Estimate"),
y = "Density",
fill = "Correlation (r)",
color = "Correlation (r)") +
theme_minimal(base_size = 14) +
theme(legend.position = "top",
plot.title = element_text(hjust = 0.5))
stargazer(biregress_3,
type = "latex",
title = "Incumbents Vote Share explained by Incumbent Presidential Candidate Vote Share",
column.labels = "Coefficients (biregress 3)",
covariate.labels = "presvote",
dep.var.labels = "voteshare")
biregress_3 <- lm(voteshare ~ presvote, data = inc.sub)
summary(biregress_3)
stargazer(biregress_3,
type = "latex",
title = "Incumbents Vote Share explained by Incumbent Presidential Candidate Vote Share",
column.labels = "Coefficients (biregress 3)",
covariate.labels = "presvote",
dep.var.labels = "voteshare")
resid_regress <- lm(res_1 ~ res_2)
#####################
# load libraries
# set wd
# clear global .envir
#####################
# remove objects
rm(list=ls())
# detach all libraries
detachAllPackages <- function() {
basic.packages <- c("package:stats", "package:graphics", "package:grDevices", "package:utils", "package:datasets", "package:methods", "package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:", search()))==1, TRUE, FALSE)]
package.list <- setdiff(package.list, basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package,  character.only=TRUE)
}
detachAllPackages()
# load libraries
pkgTest <- function(pkg){
new.pkg <- pkg[!(pkg %in% installed.packages()[,  "Package"])]
if (length(new.pkg))
install.packages(new.pkg,  dependencies = TRUE)
sapply(pkg,  require,  character.only = TRUE)
}
# here is where you load any necessary packages
# ex: stringr
# lapply(c("stringr"),  pkgTest)
# set wd for current folder
setwd("/Users/carolinekajkowski/Desktop/Trinity/Statistical Analysis I/Stats2025/problemSets/PS03/my_answers")
# read in data
inc.sub <- read.csv("/Users/carolinekajkowski/Desktop/Trinity/Statistical Analysis I/Stats2025/datasets/incumbents_subset.csv")
install.packages("stargazer")
library(stargazer)
#Q1
biregress_1 <- lm(voteshare ~ difflog, data = inc.sub)
summary(biregress_1)
stargazer(biregress_1,
type = "latex",
title = "Incumbent Vote Share explained by Difference of Spending",
column.labels = "Coefficients (Reg 1)",
covariate.labels = "difflog",
dep.var.labels = "voteshare")
plot(inc.sub$difflog, inc.sub$voteshare,
main = "Plot of Difference in Spending and Vote Share",
xlab = "Difference of Spending between incumbent and challenger",
ylab = "Incumbent's Vote Share ",
abline(biregress_1, col = "red", lwd = 2))
res_1 <- biregress_1$residuals
#Yi = 0.579031 + 0.041666Xi + ei
#Q2
biregress_2 <- lm(presvote ~ difflog, data = inc.sub)
summary(biregress_2)
stargazer(biregress_2,
type = "latex",
title = "Presidential Candidate Vote Share explained by Difference of Spending",
column.labels = "Coefficients (biregress 2)",
covariate.labels = "difflog",
dep.var.labels = "presvote")
plot(inc.sub$difflog, inc.sub$presvote,
main = "Plot of Difference in Spending and Vote Share of the Incumbent Presidential Candidate",
xlab = "Difference of Spending between incumbent and challenger",
ylab = "Imcumbent Presidential Candidate Vote Share",
abline(biregress_2, col = "red", lwd = 2))
res_2 <- biregress_2$residuals
# Yi = 0.507583 + 0.023837Xi + ei
#Q3
biregress_3 <- lm(voteshare ~ presvote, data = inc.sub)
summary(biregress_3)
stargazer(biregress_3,
type = "latex",
title = "Incumbents Vote Share explained by Incumbent Presidential Candidate Vote Share",
column.labels = "Coefficients (biregress 3)",
covariate.labels = "presvote",
dep.var.labels = "voteshare")
plot(inc.sub$presvote, inc.sub$voteshare,
main = "Relationship Between Presidential and Incumbent Party Vote Share",
xlab = "Imcumbent Presidential Candidate Vote Share",
ylab = "Incumbent Party's Vote Share",
abline(biregress_3, col = "red", lwd = 2))
#Yi = 0.441330 + 0.388018Xi + ei
#Q4
resid_regress <- lm(res_1 ~ res_2)
summary(resid_regress)
res_2 <- biregress_2$residuals
res_1 <- biregress_1$residuals
resid_regress <- lm(res_1 ~ res_2)
summary(resid_regress)
stargazer(resid_regress,
type = "latex",
title = "Residuals of Incumbents Vote Share explained by Residuals of Incumbent Presidential Candidate Vote Share",
column.labels = "Coefficients (residuals)",
covariate.labels = "res_2",
dep.var.labels = "res_1")
install.packages("stargazer")
library(stargazer)
summary(resid_regress)
stargazer(resid_regress,
type = "latex",
title = "Residuals of Incumbents Vote Share explained by Residuals of Incumbent Presidential Candidate Vote Share",
column.labels = "Coefficients (residuals)",
covariate.labels = "res_2",
dep.var.labels = "res_1")
stargazer(resid_regress,
type = "latex",
title = "Incumbents Vote Share explained by Difference in Spending and Incumbent Presidential Candidate Vote Share",
column.labels = "Coefficients (residuals)",
covariate.labels = "difflog", "presvote"
dep.var.labels = "voteshare")
stargazer(resid_regress,
type = "latex",
title = "Incumbents Vote Share explained by Difference in Spending and Incumbent Presidential Candidate Vote Share",
column.labels = "Coefficients (residuals)",
covariate.labels = c("difflog", "presvote"),
dep.var.labels = "voteshare")
multi_regress <- lm(voteshare ~ difflog + presvote, data = inc.sub)
summary(multi_regress)
stargazer(multi_regress,
type = "latex",
title = "Incumbents Vote Share explained by Difference in Spending and Incumbent Presidential Candidate Vote Share",
column.labels = "Coefficients (residuals)",
covariate.labels = c("difflog", "presvote"),
dep.var.labels = "voteshare")
